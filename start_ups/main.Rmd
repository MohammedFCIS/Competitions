---
title: "Startups Business Analytics"
author: "Mohammed Ali, Ali Ezzat, Sami Emad" 
date: "February 17, 2018"
output:
    html_document:
      toc : true
      levels : 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(quanteda)
library(psych)
library(mice) 
library(VIM)
```

# Objective
Our main goal here is to see how we can walk through a business case to analyze it and conclude useful results from it. Although the dataset here is a dummy one, it has the same issues as most real datasets like:

* A lot of predictors to comperhend and get usefl info from them.
* Data has a lot of missing, unclear items.
* Amiguate relation between the predictors

So let us begin our journey.

# Data Wrangling
First we will read the data using `read_csv` methof from `readr` packing within `tidyverse` package.

```{r read_data, message=FALSE}
startups <- read_csv("data/CAX_Startup_Data.csv")
```
So we have `r nrow(startups)` observations belongs to `r ncol(startups)` variables, one of them is the response variable that we would to designate later for predction and the rest are the predictors.

Let us see how the first 5 rows of the data looks like
```{r data_head}
head(startups, 5)
```

From that it seems we have the following notes:

* There are many missong values 
* Missing values are not only marked as `NA` but there are other values like `No Info` or just an empty string.
* Varaible are read as _characters_ datatype by default and would need to be probably converted to their _original_ data type(dates, factors, numeric)
* There are variables clearly will need special processing like `Short Description of company profile` , `Specialization of highest education` or `
Investors`
* There are issues in texual columns (upper and lower case, different format, etc..)
* Clearly `Dependent-Company Status` is the response variable.

So, the following are the steps we will conduct to clean our dataset

* Unify the way missing data are marked.
* Will convert the variables into their proper datatypes.
* Remove column with missed data over 40%.

## Setup Missing Data

```{r set_missing}
set_missing <- function(x) {
  # Replace 'No Info' with NA
  x[x == 'No Info'] <- NA
  # Replace empty string with NA
  x[x == ''] <- NA
  return(x)
}

startups <- map_df(startups, set_missing)
```

## Variables Correct type
### Factor Variables

Construct factor of factor variables and convert them

```{r convert_factors}
factor_cols <- c(2, 12, 16:17, 24, 26:65, 67, 71, 73, 75:87, 89:91, 93, 97, 100:101)
startups[, factor_cols] <- map_df(startups[, factor_cols], toupper)
startups[, factor_cols] <- map_df(startups[, factor_cols], as.factor)
```

Let us look at the `summary` for each variable to make sure that everything is ok.
```{r convert_factors_summary}
map(startups[, factor_cols], summary)
```

It seems that everything in order. However, there is a small note about some variables are about the *investors/owners/founders* not about the company itself which should not be there as certainly each person has his/her own qualifications and experience, but for sake of simplicity we will consider these varaibles are talking about all of these people at once as one unit.

### Numeric Variables
Construct factor of numeric variables and convert them

```{r convert_numeric, message=FALSE, warning=FALSE}
numeric_cols <- c(3:5,10,11,18:23,25,61,66,68:70,72,74,88,92,94:96,98,99,102:116)
startups[, numeric_cols] <- map_df(startups[, numeric_cols], as.numeric)
```

Let us look at the `summary` for each variable to make sure that everything is ok.
```{r convert_numeric_summary}
map(startups[, numeric_cols], summary)
```

It seems that seems that there are some outliers there, we will find out more we reach the EDA phase.

### Date Variables
Construct factor of date variables and convert them

```{r convert_date}
date_cols <- c(13:14)
startups[, date_cols] <- map_df(startups[, date_cols], mdy)
```

Let us look at the `summary` for each variable to make sure that everything is ok.
```{r convert_date_summary}
map(startups[, date_cols], summary)
```

## Remove polluted predictors
Now, as the variables in their proper data types, let us remove predictors with more than 40% missing data

```{r remove_poll_vars}
startups <- startups[colSums(is.na(startups))/nrow(startups) < .4]
dim(startups)
```
It seems we git rid off 3 variables, let us take another look at the data now
```{r top_5}
head(startups)
```

Much better.

## Feature Engineering
### Textual Variables
Textual columns are those that contain *free text*. What differentiates these from the categorical columns is that the number of unique values for the textual columns would be too big. Such columns are typically messy, and we will have to deal with them on a column-by-column basis as no single preprocessing procedure would suit them all.

Before we move on, let's modify the column names by making them lowercase and replacing spaces with underscores. Note that this is more of a personal preference than a neccessity.
```{r modify_colnames}
colnames(startups) <- tolower(gsub(x = colnames(startups), pattern = ' ', replacement = '_', fixed = TRUE))
# the 'fixed' parameter is set as TRUE in order to match the pattern exactly. 
# otherwise, the pattern will be interpreted as a regular expression instead, and an unexpected output may result.

# see effect of last command
head(colnames(startups))
```
After a quick manual inspection (on the .csv file), we identified the following textual variables. We additionally set the contents of these columns to lowercase for easier processing later on.
```{r textual_vars}
# the columns containing text in them
textual_col_names <- c('industry_of_company',
                       'short_description_of_company_profile',
                       'focus_functions_of_company',
                       'investors')

# set contents of these columns to lowercase
startups[,textual_col_names] <- map_df(startups[,textual_col_names], tolower)
```




#### Industry of the Company
And now, a quick look at the *industry_of_company* column -- which indicates the particular domain that a company is working in -- shows us...

```{r comp_indust}
head(startups$industry_of_company, 10)
```
From the output, it seems that it is a multiple-value variable with `|` as the separator.

Now, we wish to create a [*document-term matrix*](https://en.wikipedia.org/wiki/Document-term_matrix) (DTM) from this column. The DTM is a matrix where the documents (i.e. records) and terms (e.g. words) are the rows and columns, respectively, and the cells contain the frequencies of the terms occurring in the documents (e.g. the cell *DTM(i,j)* would tell how many times term *j* occurred in document *i*).  To generate the DTM, we shall use the [quanteda](https://cran.r-project.org/web/packages/quanteda/) package.

```{r }
# create the corpus object from the industry_of_company column
mycorpus <- corpus(startups$industry_of_company)

# generate the DTM using the formed corpus
dfm_industry <- dfm(mycorpus,               # the corpus to generate the DTM from
                    tolower = FALSE)        # data is already lowercase
```

At this point, let's just have a look at the DTM before moving on.

```{r }
# observe the 'terms' of the DTM
colnames(dfm_industry)
```

Unfortunately, the output is unsatisfactory. Some of the terms that are parsed by the [quanteda](https://cran.r-project.org/web/packages/quanteda/) package include `|`, `/`, `&`, `(` and `)` (improper terms, obviously). We also observe that industries such as `cloud computing` and `software development` have been broken down into their constituent words, which is also incorrect.

With some investigation of the [quanteda](https://cran.r-project.org/web/packages/quanteda/) package (specifically the `quanteda::tokens()` function), it seems that it is only able to split the terms over the *spaces* in the text. In other words, we cannot specify the `|` character as the separator for splitting the text into terms.

As such, we will deal with this issue by performing the following actions:

* **Replace spaces with underscores:** merges each of the multi-word industries into a single term.
* **Replace occurrences of the `|` character with spaces:** helps the `quanteda::dfm()` function split the terms over the new spaces.
* **Remove the special characters, `/`, `&`, `(` and `)`:** makes life easier for the `quanteda::dfm()` function.

It may be a good idea to look at the cases on which we intend to perform the above actions. Let's have a look.

```{r }
# retrieve and view those industries that have '/' in them
startups$industry_of_company[ grepl(x = startups$industry_of_company, pattern = '/', fixed = TRUE) ]
```

```{r }
# retrieve and view those industries that have '&' in them
startups$industry_of_company[ grepl(x = startups$industry_of_company, pattern = '&', fixed = TRUE) ]
```

```{r }
# retrieve and view those industries that have '(' in them
startups$industry_of_company[ grepl(x = startups$industry_of_company, pattern = '(', fixed = TRUE) ]
```

From the above inspections, it seems that all occurrences of `/` are in the terms `network / hosting / infrastructure` and `career / job search`. As for `&` and `(`, their occurrences are in the terms `food & beverages` and `human resources (hr)`, respectively. Accordingly, we perform the following modifications to the `industry_of_company` variable.

```{r }
# remove all occurrences of ' (hr)', ' /', ' &'
startups$industry_of_company <- gsub(startups$industry_of_company, pattern=' (hr)', replacement='', fixed=TRUE)
startups$industry_of_company <- gsub(startups$industry_of_company, pattern=' /',    replacement='', fixed=TRUE)
startups$industry_of_company <- gsub(startups$industry_of_company, pattern=' &',    replacement='', fixed=TRUE)

# replace spaces with underscores to merge multi-word terms
startups$industry_of_company <- gsub(startups$industry_of_company, pattern=' ',     replacement='_', fixed=TRUE)

# replace all occurrences of '|' with spaces to separate between terms
startups$industry_of_company <- gsub(startups$industry_of_company, pattern='|',     replacement=' ', fixed=TRUE)

head(startups$industry_of_company, 10)
```

Modifications have been applied successfully and as intended; i.e. multi-word terms are merged with underscores, and the terms are separated by spaces. Now, let's generate the DTM and observe the obtained terms.

```{r }
# create the corpus object from the industry_of_company column
mycorpus <- corpus(startups$industry_of_company)

# generate the DTM using the formed corpus
dfm_industry <- dfm(mycorpus,               # the corpus to generate the DTM from
                    tolower = FALSE)        # data is already lowercase

# observe the 'terms' of the DTM
colnames(dfm_industry)
```
At last, we can move on to the *analysis* of the `industry_of_company` variable.

Let's create a new data frame object where we bind the industry's DTM with the column of the response variable. Note that the DTM is currently of type `matrix`, so we need to coerce it into a `data.frame` before binding.

```{r }
# convert `dfm_industry` to data.frame and bind with response variable
startups_industry <- cbind(startups[,2], as.data.frame(dfm_industry))

glimpse(startups_industry)
```

The bind appears to be successful. Now, let's view the frequency of each of the industries among the list of companies in the dataset. Let's remove the `NA` industry as it does nothing for us.

```{r }
# remove the NA industry (column)
startups_industry <- 
  startups_industry %>% 
  select(-`NA`)

glimpse(startups_industry)
```

Alright. Let's now view the successes and failures under each industry. Specifically, we want (1) to have the rows be the industries and (2) to have two columns, *success* and *fail*, showing us the numbers of successful and failed companies, respectively, in each of the industries.

```{r }
# (1) have the rows be the industries
industry_frequencies <-
  startups_industry %>% 
  # "industry" column gathers the industries (i.e. keys) from the former columns
  # "binary" column holds the values from the former columns
  gather("industry", "binary", 2:41) %>% 
  #summarise the binary columns from the DTM into two values per industry (one for success/fail each)
  group_by(`dependent-company_status`, industry) %>% 
  summarise(frequency = sum(binary))

industry_frequencies
```

```{r }
# (2) have two columns, 'success' and 'failed'
industry_frequencies <-
  industry_frequencies %>% 
  spread(`dependent-company_status`, frequency)

# make column names lowercase
colnames(industry_frequencies) <- tolower(colnames(industry_frequencies))

industry_frequencies %>% 
  arrange(desc(success))
```

Let's visualize the above information.

```{r fig.align='center'}
# visualize number of successful companies per industry
industry_frequencies %>% 
  transform(industry=reorder(industry, -success) ) %>%        # order x-axis labels by '-success'
  ggplot(aes(x = industry, y = success)) +                    # X: industry, Y: #successful companies
  geom_bar(stat="identity") +                                 #
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.3,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

```{r fig.align='center'}
# visualize number of successful/failed companies per industry
industry_frequencies %>% 
  gather("company_status", "n", 2:3) %>% 
  transform(industry=reorder(industry, -n) ) %>%              # order x-axis labels by '-success'
  ggplot(aes(x = industry, y = n, fill = company_status)) +   # X: industry, Y: n, fill: company_status
  geom_bar(stat="identity") +                                 #
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.3,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

From the figure, it seems that most startups actually succeed regardless of the industry. Why don't we get some exact numbers? Below, we will create a new variable called `success_percent` which displays the percentage of successful companies per industry.

```{r }
# view industries arranged by percentage of successful companies per industry
industry_frequencies %>% 
  mutate(success_percent = round(success / (success+failed) * 100, 1)) %>% 
  arrange(desc(success_percent), desc(success))
```

Ahem... I want to see the ENTIRE thing, please?

```{r }
# view industries arranged by percentage of successful companies per industry
industry_frequencies %>% 
  mutate(success_percent = round(success / (success+failed) * 100, 1)) %>% 
  arrange(desc(success_percent), desc(success)) %>% 
  as.data.frame()   # override dplyr's tibble output
```

All endeavors in `retail`, `security` and `hospitality` seem to have ended in success. There are other industries that have flawlessly succeeded as well, but the number of successes are not big enough to be significant. 

For the industries with success ratios < 100%, `analytics` seems to be wildly successful with a ~91% success ratio, followed by `enterprise_software`, `marketing` and `advertising`, all with success ratios > 70%. There are still other industries with success ratios > 70%, but (again) the number of companies in these industries are not big enough for the percentages to be significant. 

On the other side of the spectrum, there exist industries that are wildly UNsuccessful such as `space_travel` and `classifieds`. Although the numbers of companies are not significant enough to draw conclusions, we don't need numbers to tell us that `space_travel` is a tough business to get into :). Other industries with more fails than successes are `music`, `food_beverages` and `search`. 

Industries in the *hit-or-miss* region (~50% success ratio) include `entertainment`, `network_hosting_infrastructure`, `education` and `telecommunications`. Again, other industries within this *hit-or-miss* region do not have a significantly large number of companies to constitute a trend and, as such, will be ignored.

Below, we take another quick look at the industries containing the bigger numbers of successful companies.

```{r }
# view industries arranged by percentage of successful companies per industry
industry_frequencies %>% 
  mutate(success_percent = round(success / (success+failed) * 100, 1)) %>% 
  arrange(desc(success), desc(success_percent))
```

We realize that while not all of the above 10 industrues contain superb success percentages, they are all > 60%.

Now, let's have a look at one of the industries (as an example), particularly its failed companies. We shall observe the `analytics` industry.

```{r }
analytic_startups_failed <- 
  startups_industry %>% 
  filter(analytics == 1, `dependent-company_status` == 'FAILED') %>%
  select(-c(`dependent-company_status`, `analytics`))   # don't need these columns anymore

analytic_startups_failed[,colSums(analytic_startups_failed) > 0] %>% 
  colSums() %>% 
  sort() %>% 
  t() %>% t()
```

Nothing particularly interesting here. Let's try the same thing, but with the successful companies of the `analytics` industry.

```{r }
analytic_startups_success <- 
  startups_industry %>% 
  filter(analytics == 1, `dependent-company_status` == 'SUCCESS') %>%
  select(-c(`dependent-company_status`, `analytics`))   # don't need these columns anymore

analytic_startups_success[,colSums(analytic_startups_success) > 0] %>% 
  colSums() %>% 
  sort() %>% 
  t() %>% t()
```

The hot industries in `analytics` seems to be the `marketing`, `mobile`, `e-commerce`, `enterprise_software` and `advertising` industries. Let's do some SUCCESS/FAILED comparison.

```{r }
# summarize the industries within 'analytics'
analytic_startups_summary <- t(rbind(colSums(analytic_startups_failed), colSums(analytic_startups_success)))

# modify column names
colnames(analytic_startups_summary) <- c('failed','success')

analytic_startups_summary[order(-analytic_startups_summary[,2]),]
```

The above output would look more interesting visualized.

```{r fig.align='center'}
# add the industries (currently the row names) as a column in 'analytic_startups_summary'
analytic_startups_summary <- cbind(rownames(analytic_startups_summary), analytic_startups_summary)

# remove the row names
rownames(analytic_startups_summary) <- NULL

# set the column names
colnames(analytic_startups_summary) <- c('industry','failed','success')

# convert to data frame
analytic_startups_summary <- as.data.frame(analytic_startups_summary, stringsAsFactors = FALSE)

# convert the numeric columns to type 'numeric'
analytic_startups_summary[,c("failed","success")] <- 
  map_df(analytic_startups_summary[,c("failed","success")], as.numeric)

# visualize number of successful/failed analytics companies per industry
analytic_startups_summary %>% 
  gather("company_status", "n", 2:3) %>% 
  transform(industry=reorder(industry, -n) ) %>%              # order x-axis labels by '-success'
  ggplot(aes(x = industry, y = n, fill = company_status)) +   # X: industry, Y: n, fill: company_status
  geom_bar(stat="identity") +                                 #
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.3,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

The [ggplot2](https://cran.r-project.org/web/packages/ggplot2/) prefers the data be in a *tidy* format (all variables in columns, all observations in rows, all cells containing a single value each). As far as the `ggplot()` function is concerned, it is expecting us to specify a variable (column) as the x-axis and another variable (column) as the y-axis. This is why the industries were added as a column in the data frame (to be later displayed as the x-axis in the visualization). The `dplyr::gather()` function was used to produce a nice-looking visualization of the entire data together (instead of just either the failed or succesful companies alone).

Let's do the above analysis again but for companies that do NOT have `analytics` as one of its industries.

```{r }
non_analytic_startups_failed <- 
  startups_industry %>% 
  filter(analytics == 0, `dependent-company_status` == 'FAILED') %>%
  select(-c(`dependent-company_status`, `analytics`))   # don't need these columns anymore

non_analytic_startups_success <- 
  startups_industry %>% 
  filter(analytics == 0, `dependent-company_status` == 'SUCCESS') %>%
  select(-c(`dependent-company_status`, `analytics`))   # don't need these columns anymore

# summarize the industries within 'analytics'
non_analytic_startups_summary <- t(rbind(colSums(non_analytic_startups_failed),
                                         colSums(non_analytic_startups_success)))

# modify column names
colnames(non_analytic_startups_summary) <- c('failed','success')

non_analytic_startups_summary[order(-non_analytic_startups_summary[,2]),]
```

```{r fig.align='center'}
# add the industries (currently the row names) as a column in 'analytic_startups_summary'
non_analytic_startups_summary <- cbind(rownames(non_analytic_startups_summary), non_analytic_startups_summary)

# remove the row names
rownames(non_analytic_startups_summary) <- NULL

# set the column names
colnames(non_analytic_startups_summary) <- c('industry','failed','success')

# convert to data frame
non_analytic_startups_summary <- as.data.frame(non_analytic_startups_summary, stringsAsFactors = FALSE)

# convert the numeric columns to type 'numeric'
non_analytic_startups_summary[,c("failed","success")] <- 
  map_df(non_analytic_startups_summary[,c("failed","success")], as.numeric)

# visualize number of successful/failed non-analytics companies per industry
non_analytic_startups_summary %>% 
  gather("company_status", "n", 2:3) %>% 
  transform(industry=reorder(industry, -n) ) %>%              # order x-axis labels by '-success'
  ggplot(aes(x = industry, y = n, fill = company_status)) +   # X: industry, Y: n, fill: company_status
  geom_bar(stat="identity") +                                 #
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.3,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

An interesting result, indeed! It seems that companies that adopt analytics capabilities have a much larger chance of success.

To finalize this analytics/non-analytics investigation, let's stack three visualizations (like the one above) on top of each other:
* the `analytics` companies
* the non-`analytics` companies
* all the companies.


```{r fig.align='center'}

library(gridExtra)

top_plot <- 
  industry_frequencies %>% 
  filter(industry != "analytics") %>%                         # ignore the 'analytics' industry
  gather("company_status", "n", 2:3) %>% 
  ggplot(aes(x = industry, y = n, fill = company_status)) +   # X: industry, Y: n, fill: company_status
  geom_bar(stat="identity") +                                 #
  theme(axis.title.x = element_blank(),                       # blanking out x-axis labels so 
        axis.text.x = element_blank(),                        # ...visualizations would fit on 
        axis.ticks.x = element_blank(),                       # ...top of each other
        axis.title.y = element_blank())                       # blanking out y-axis labels so 

middle_plot <- 
  analytic_startups_summary %>% 
  gather("company_status", "n", 2:3) %>% 
  ggplot(aes(x = industry, y = n, fill = company_status)) +   # X: industry, Y: n, fill: company_status
  geom_bar(stat="identity") +                                 #
  scale_y_continuous(limits = c(0,60)) +                      # fix limits for y-scale
  theme(axis.title.x = element_blank(),                       # blanking out x-axis labels so 
        axis.text.x = element_blank(),                        # ...visualizations would fit on 
        axis.ticks.x = element_blank(),                       # ...top of each other
        axis.title.y = element_blank())                       # blanking out y-axis labels so 

bottom_plot <- 
  non_analytic_startups_summary %>% 
  gather("company_status", "n", 2:3) %>% 
  ggplot(aes(x = industry, y = n, fill = company_status)) +   # X: industry, Y: n, fill: company_status
  geom_bar(stat="identity") +                                 #
  ylim(0,60) +                                                # fix limits for y-scale
  theme(axis.title.x = element_blank(),                       # blanking out x-axis labels so 
        axis.text.x = element_blank(),                        # ...visualizations would fit on 
        axis.ticks.x = element_blank(),                       # ...top of each other
        axis.title.y = element_blank())                       # blanking out y-axis labels so 

grid.arrange(top_plot, middle_plot, bottom_plot, ncol=1)
```

The above figure confirms what we already know about the data so far, and that is: `analytics` dramatically increases the chances that a startup will ultimately succeed.

Now that we performed some data analysis revolving around the `analytics` industry, we want to do something systematic over all the industries. First, we want to make sure that, for example, `mobile analytics` and `analytics mobile` to count as two separate industries. We also want to shorten the words for visualization purposes later.

```{r }
# alphabetically sorts the list of industries for each company
industrySorter<- function(industries) {
  if(is.na(industries)) {
    industries <- ""
  } 
  else {
    industries <-                 # e.g. "gaming entertainment mobile"
      industries %>%              #
      strsplit(" ") %>%           # "gaming" "entertainment" "mobile"
      unlist() %>%                #
      sort() %>%                  # "entertainment" "gaming" "mobile"
      tokens() %>%
      tokens_wordstem() %>%       # "entertain" "game" "mobil"
      paste(collapse = " ")       # "entertain game mobil"
  }
  return(industries)
}
startups$industry_of_company <- map_chr(startups$industry_of_company, industrySorter)

startups$industry_of_company %>% 
  head(10)
```

```{r }
# show all the industry combinations in the data and the number of companies in each
startups%>% 
  group_by(industry_of_company) %>% 
  summarise(companies = n()) %>% 
  arrange(industry_of_company)       # sort industries alphabetically
```

```{r }
# show all the industry combinations in the data and the number of companies in each
startups%>% 
  group_by(industry_of_company) %>% 
  summarise(companies = n()) %>% 
  arrange(desc(companies))       # sort industries by number of companies
```

Let's try doing something more useful.

```{r }
# show all the industry combinations in the data and the number of failed/successful companies in each
startups%>% 
  group_by(industry_of_company, `dependent-company_status`) %>% 
  summarise(companies = n()) %>% 
  arrange(desc(companies))       # sort industries by number of companies
```

Let's convert the above data into a *tidy* format.

```{r }
# show all the industry combinations in the data and the number of failed/successful companies in each
startups%>% 
  group_by(industry_of_company, `dependent-company_status`) %>% 
  summarise(companies = n()) %>% 
  spread(`dependent-company_status`, companies) %>% 
  arrange(desc(SUCCESS))       # sort industries by number of successful companies
```

Let's remove the first row (corresponding to the `NA` industry) and replace the NA's within the table with 0's.

```{r }
my_summarised_startups_industry <- 
  startups%>% 
  group_by(industry_of_company, `dependent-company_status`) %>% 
  summarise(companies = n()) %>% 
  spread(`dependent-company_status`, companies) %>% 
  filter(industry_of_company != "") %>% 
  arrange(desc(SUCCESS))       # sort industries by number of successful companies

# replace the NA's with 0's
my_summarised_startups_industry[is.na(my_summarised_startups_industry)] <- 0

my_summarised_startups_industry
```

It appears we have 173 unique indutry combinations in the data. Let's visualize them. Note, however, that these industry combinations would never all fit on the x-axis which is why

```{r fig.align='center'}
my_summarised_startups_industry %>% 
  head(25) %>%
  gather("company_status","n",2:3) %>% 
  mutate(short_indust = strtrim(industry_of_company, 20)) %>% 
  transform(short_indust=reorder(short_indust, -n) ) %>%      # order x-axis labels by '-n'
  ggplot(aes(x=short_indust, y=n, fill=company_status)) +     # X: industry, Y: #successful companies
  geom_bar(stat="identity") +                                 #
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.3,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

Now, let's show the industry combinations with the highest fail rates.

```{r }
my_summarised_startups_industry <-
  my_summarised_startups_industry %>% 
  arrange(desc(FAILED))

my_summarised_startups_industry
```

```{r fig.align='center'}
my_summarised_startups_industry %>% 
  head(25) %>%
  gather("company_status","n",2:3) %>% 
  mutate(short_indust = strtrim(industry_of_company, 20)) %>% 
  transform(short_indust=reorder(short_indust, -n) ) %>%      # order x-axis labels by '-n'
  ggplot(aes(x=short_indust, y=n, fill=company_status)) +     # X: industry, Y: #successful companies
  geom_bar(stat="identity") +                                 #
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.3,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

Let's have a look at the effect of the company founding date on the chance of success. It may be the case that startups were still getting the hang of it in earlier days and, as time went by, a bunch of common mistakes done by the earlier startups were avoided by the following ones. We will repeat this analysis twice, once for all companies in general and another time for companies that have `analytics` as one of its industries.

```{r fig.align='center'}
startups %>% 
  separate(est._founding_date,c("found_year","found_month","found_day"),"-") %>% 
  filter(!is.na(found_year)) %>% 
  select(found_year, `dependent-company_status`) %>% 
  ggplot(aes(x = found_year, fill = `dependent-company_status`)) +
  geom_histogram(stat="count") +
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.4,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

A quick look at the above figure shows that the percentage of successful companies has increased in the last five years. Let's see it in numbers.

```{r }
startups %>% 
  separate(est._founding_date,c("found_year","found_month","found_day"),"-") %>% 
  filter(!is.na(found_year)) %>% 
  select(found_year,`dependent-company_status`) %>% 
  group_by(found_year,`dependent-company_status`) %>% 
  summarise(count = n()) %>% 
  spread(`dependent-company_status`, count) %>% 
  replace_na(list(FAILED = 0, SUCCESS = 0)) %>%                # replace NA's with 0's
  mutate(success_percent = SUCCESS / (SUCCESS + FAILED)) %>%   # create success_percent variable
  arrange(desc(success_percent))                               # sort descendingly by success_percent
```

From the above output, it is clear that the higher success percentages are more towards recent years. The first two rows, (i.e. years 1999 and 2002) have too few companies for their success percentages to be significant, so we'll pretend they are not there.

Now, let's repeat the above couple of steps for `analytics`-inclined companies and see if we get similar observations.

```{r fig.align='center'}
startups %>% 
  separate(est._founding_date,c("found_year","found_month","found_day"),"-") %>% 
  filter(!is.na(found_year) & grepl("analyt", industry_of_company)) %>%  # analytics companies only
  select(found_year, `dependent-company_status`) %>% 
  ggplot(aes(x = found_year, fill = `dependent-company_status`)) +
  geom_histogram(stat="count") +
  theme(axis.text.x = element_text(angle = 90,                # rotate orientation of x-axis labels
                                   vjust = 0.4,               # top-align x-axis labels
                                   hjust = 1))                # right-align x-axis labels
```

```{r }
startups %>% 
  separate(est._founding_date,c("found_year","found_month","found_day"),"-") %>% 
  filter(!is.na(found_year) & grepl("analyt", industry_of_company)) %>%  # analytics companies only
  select(found_year,`dependent-company_status`) %>% 
  group_by(found_year,`dependent-company_status`) %>% 
  summarise(count = n()) %>% 
  spread(`dependent-company_status`, count) %>% 
  replace_na(list(FAILED = 0, SUCCESS = 0)) %>%                # replace NA's with 0's
  mutate(success_percent = SUCCESS / (SUCCESS + FAILED)) %>%   # create success_percent variable
  arrange(desc(success_percent))                               # sort descendingly by success_percent
```

From the above figure and results, `analytics` seems to have higher success percentages than those seen for all companies regardless of industry. The lowest osberved success percentage for `analytics` companies was observed in 2006. However, there were only 3 startups in 2006. For the rest of the years, the success percentages were generally quite high (> 80%). Again, these higher percentages are more meaningful for the recent years that have seen more startups.


*To be continued...*



















#### Short description of company profile

Until now I do not know what to do with it

```{r desc}
head(startups$short_description_of_company_profile, 10)
```

The NA's will probably cause problems at the DTM generation step later, so let's remove them.

```{r }
# eliminate NA's
startups$short_description_of_company_profile[is.na(startups$short_description_of_company_profile)] <- ''

head(startups$short_description_of_company_profile, 10)
```

Let's carry on and generate the DTM matrix.

```{r }
# create the corpus object from the short_description_of_company_profile column
mycorpus <- corpus(startups$short_description_of_company_profile)

# list of stop words
my_stopwords <- stopwords('english')

# generate the DTM using the formed corpus
dfm_desc <- dfm(mycorpus,               # the corpus to generate the DTM from
                remove_punct = TRUE,    # remove punctuation
                remove_symbols = TRUE,  # remove symbols
                remove = my_stopwords,  # remove stopwords
                tolower = FALSE)        # data is already lowercase
```

Like before, let's have a look at the DTM before moving on.

```{r }
# observe the 'terms' of the DTM
colnames(dfm_desc)
```

This resulted in 463 distinct terms. Let's see if we can shrink that number further by stemming. There are a few terms that end in *'s* that we will deal with as well. By the way, we see the `<U+FB01>nancial` term, but we are just ignoring it for now.

```{r }
# remove the 's
startups$short_description_of_company_profile <- 
  gsub(x = startups$short_description_of_company_profile, pattern = '\'s', replacement = '')

# create the corpus object from the short_description_of_company_profile column
mycorpus <- corpus(startups$short_description_of_company_profile)

# list of stop words
my_stopwords <- stopwords('english')

# generate the DTM using the formed corpus
dfm_desc <- dfm(mycorpus,               # the corpus to generate the DTM from
                remove_punct = TRUE,    # remove punctuation
                remove_symbols = TRUE,  # remove symbols
                remove = my_stopwords,  # remove stopwords
                tolower = FALSE)        # data is already lowercase

# stem the terms of the dfm
dfm_desc <- dfm_wordstem(dfm_desc)

# observe the 'terms' of the DTM
dim(dfm_desc)
```

We manged to shrink the number of terms from 463 to 412 terms. We noticed that there are terms containing only a single letter (`r` and `s`). Let's have a look at some of the records (i.e. companies) that possess these single-lettered terms.

```{r }
# show the cases having the 'r' term
startups$short_description_of_company_profile[as.logical(dfm_desc[,"r"])]
```

```{r }
# show the cases having the 's' term
startups$short_description_of_company_profile[as.logical(dfm_desc[,"s"])]
```

Okay. The `r` term makes sense, but the `s` does not seem very useful. Let's remove it.

```{r }
# remove the 's' term from the DTM
dfm_desc <- dfm_desc[,-which(colnames(dfm_desc)=='s')]

# confirm 's' column was removed
dim(dfm_desc)
```

Since the number of observations (or records) in this dataset is quite low, we are expecting a lot of the terms in the DTM matrix to have only a single occurrence in the dataset. Let's see if we are right.

```{r }
# how many of the terms have single occurrences?
sum(colSums(dfm_desc) == 1)
```

Indeed, 270 out of 412 terms are single-occurring terms. What about terms with two or less occurrences?

```{r }
# how many of the terms have single occurrences?
sum(colSums(dfm_desc) <= 2)
```

Let's remove these low-frequency terms and analyze the rest.

```{r }
# remove the low-frequency terms from the DTM
dfm_desc <- dfm_desc[,-which(colSums(dfm_desc) <= 2)]

# check new size of DTM
dim(dfm_desc)
```

Now, let's see the number of failed/successful companies (plus percentage of successful companies) for each of the remaining 87 terms.

```{r }
# convert `dfm_desc` to data.frame and bind with response variable
startups_desc <- cbind(startups[,2], as.data.frame(dfm_desc))

str(startups_desc)
```

First, let's have a look at the following histogram.

```{r fig.align='center'}
qplot(colSums(dfm_desc), geom="histogram") 
```

The majority of the terms are at the low-frequency end, which shouldn't come as a surprise. 

```{r }
startups_desc%>% 
  gather("term","binary",2:88) %>% 
  group_by(term) %>% 
  summarise(companies = sum(binary == 1)) %>% 
  arrange(desc(companies))
```

Another way to show the above information is to display the number of failed and successful companies per term. We do that below.

```{r }
startups_desc %>% 
  gather("term","binary",2:88) %>% 
  group_by(`dependent-company_status`, term) %>% 
  summarise(frequency = sum(binary)) %>% 
  spread(`dependent-company_status`, frequency) %>% 
  mutate(success_percent = SUCCESS/(SUCCESS+FAILED)*100) %>% 
  arrange(desc(success_percent),desc(SUCCESS)) %>% 
  as.data.frame()
```

For some reason, the `analyt` companies sum up to 59, while in the previous table, they were 57 companies. Where did the extra two companies come from? This is a mystery that is yet unsolved. Besides that, let's observe the above table. 

For those terms with 100% success rates, we see terms like `intellig`, `real-tim`, `api` and `dashboard`, which are terms that are related to data science and business intelligence. This suggests that startups in such fields are likely to succeed. This is further confirmed by other terms with slightly smaller success rates like `analyt`, `big`, `data` and `predict`. Other terms that have promising success rates as well are `mobil` and `web`.

For terms hovering around the 50% success mark, the strongest examples are `social`, `media` and `market`. We say 'strongest' due to the high number of companies involved, which increases our confidence in the observed success rate. For these terms, it seems that there are still lessons to be learned for startups that are considering providing services related to such terms. Other terms that seem to involve risky endeavors are `cloud` and `music`.

Finally, we have a look at terms with very low success rates. It is no surprise that terms like `game` and `payment` are on this list. The gaming industry is very competitive and can be really tough to get into, and a payment-faciltating service that can outperform PayPal would not be easy to pull off. Other terms with low success rates are `email`, `host` and `call` which are all communication-related terms.

Let's do a few more visualizations before moving on with our analysis.

```{r fig.align='center'}
# keep the terms with the highest number of companies
high_freq_terms <- 
  startups_desc%>% 
  gather("term","binary",2:88) %>% 
  group_by(term) %>% 
  summarise(companies = sum(binary == 1)) %>% 
  arrange(desc(companies)) %>%        # sort terms by number of companies
  head(30) %>% 
  select(term) %>% 
  unlist()

startups_desc %>% 
  gather("term","binary",2:88) %>% 
  group_by(`dependent-company_status`, term) %>% 
  summarise(frequency = sum(binary)) %>%
  filter(term %in% high_freq_terms) %>% 
  arrange(desc(frequency)) %>% 
  transform(term=reorder(term, frequency) ) %>%
  ggplot(aes(x = term, y = frequency, fill = `dependent.company_status`)) +
  geom_bar(stat = 'identity') +
  coord_flip()
```

In the figure above, we focus more on the terms with more companies as we have higher confidence in the patterns include within. That is, we excluded the terms that have a fewer number of companies than the `analysi` term.

Based on the figure above, the terms `social`, `onlin`, `servic`, `softwar` and `network` may warrant further investigation due to their unfavorable success rates.

Before moving on, there is one last thing that we will try. Let's display a correlogram of the 10 most occurring terms and see if there are any interesting observations to be had.

```{r }
# correlation matrix of the top 10 occurring terms
corr_data <- cor(as.matrix(dfm_desc[,colSums(dfm_desc) %in% tail(sort(colSums(dfm_desc)),15)]))

library(ggcorrplot)
ggcorrplot(corr_data,
           hc.order = TRUE,     # order terms via heirarchical clustering
           type = "lower",
           colors = c("tomato2", "white", "springgreen3"))
```

The two strongest correlating pairs are `big+data` and `social+media`, followed by other pairs such as `analyt+predict`, `predict+solut`, `intellig+solut`, `custom+intellig` and `market+technolog` among others. This correlogram is interesting for uncovering some prevalent trends among startups (e.g. social media and custom intelligence-related solutions). Note that the terms in the figure (which form the labels of the x and y axes) are the most occurring terms in the dataset, meaning that the computed correlations are significant and meaningful.

We end our analysis of the `short_description_of_company_profile` variable here and move on.


#### Focus functions of company
It is a multi-value variable indicate the company foucs.

```{r comp_foc}
head(startups$focus_functions_of_company, 10)
```
The following are some notes about this field:
* values are either seprated by `,` or `&` and sometimes both.
* The characters case is not standarized.
* Missing functions




#### Investors
It is a multi-value variable. Values are seprated by `|`, and sometimes there are missing values
```{r investors}
head(startups$investors, 10)
```

















### Time Series Variables
This category contains the following two fields `Est. Founding Date` and `Last Funding Date`, so let us begin.
#### Missing Values
First we have to impute the missing values
```{r impute_missing_time}
#founding_date <- na.locf(startups$`Est. Founding Date`, na.rm = FALSE)
#startups$`Est. Founding Date` <- na.locf(founding_date, fromLast = TRUE)
#summary(startups$`Est. Founding Date`)

#last_funding_date <- na.locf(startups$`Last Funding Date`, na.rm = FALSE)
#startups$`Last Funding Date` <- na.locf(last_funding_date, fromLast = TRUE)
#summary(startups$`Last Funding Date`)
```


#### EDA
```{r ts_eda}
#ggplot(startups, aes(x = `Est. Founding Date`, y = `Dependent-Company Status`)) +
#  geom_point() +
#  scale_x_date('month')  +
#  ylab("Daily Bike Checkouts") +
#  xlab("")
#ggplot(daily_data, aes(Date, cnt)) + geom_line() + scale_x_date('month')  + ylab("Daily Bike Checkouts") +
#            xlab("")
```

# Checking Numeric Variables

# a function to calculate any outlier in Numeric features
```{r}
Count_Outliers <- 0
is_outlier <- function(x) {
  return(x < quantile(x, 0.25, na.rm= TRUE) - 1.5 * IQR(x, na.rm= TRUE) | x > quantile(x, 0.75, na.rm= TRUE) + 1.5 * IQR(x, na.rm= TRUE))
  } 
```

# summary of `year_of_founding` variable 
```{r Company year founding}
summary(startups$year_of_founding)
```

## list of the values, and their count
```{r}
count(startups,year_of_founding)
```

## percentage of NA value in year_of_founding feature
```{r}
NA_percnt = (count(startups$year_of_founding=="NA"))$freq[2]/nrow(startups)*100
```
 We have ablout `NA_percnt` missing value in `year_of_founding` feature.
## We will draw a histogarm of this feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA values. 
```{r Bar_chart} 
ggplot(startups, aes(x=as.factor(year_of_founding) , fill=startups$`dependent-company_status`)) + 
  geom_bar(position = "dodge")   +
  labs(title = "Year of Company Founding\n", x = "Year of Founding", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14, angle=90), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```
We have found that, most of the successfull companies were founder on 2009 and later, and it's
most likely the compnay failed before that year. In addition, the NA values shows that the companies were probably successfull which indicates they were founded on the same periods its counterparts were.

## figuiring out the outlier and labeld them
```{r checking outliers using boxpolt, warning=FALSE}
startups %>%  
  mutate(outlier = ifelse(is_outlier(year_of_founding), year_of_founding, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = year_of_founding)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$year_of_founding), startups$year_of_founding, as.numeric(NA))
outlier_count <- count(outlier!="NA")$freq[1]
outlier_percnt <- count(outlier!="NA")$freq[1]/nrow(startups)*100
```
In this `year_of_founding`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# Summary of `age_of_company_in_years` feature
```{r Summary}
summary(startups$age_of_company_in_years)
```
## list of the values, and their count
```{r List of the values}
count(startups,age_of_company_in_years)
```
## percentage of NA value in year_of_founding
```{r Percentage claculation for NA values}
(count(startups$age_of_company_in_years=="NA"))$freq[2]/nrow(startups)*100
```
# find the missing ones between both features
```{r}
md.pattern(startups[,3:4])
```
 This shows that both are related literally and NA values are not missing normally

## drwaing a histogarm of  the feature to know its type of distribution which will help us
## figuring out the best method to deal with NA vales 
```{r bar_chart grapth} 
ggplot(startups, aes(x=as.factor(age_of_company_in_years) , fill=startups$`dependent-company_status`)) + 
   geom_bar(position = "dodge")   +
   labs(title = "Company Age in Years\n", x = "Company Age in Years", y = "Count", fill= "Success|Failed\n ") +
   scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
   theme_bw() +
   theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
         axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
         plot.title=element_text(size=20, face="bold", color="darkgreen"))
```
 
## figuiring out the outlier and labeld them
```{r feature outliers, warning=FALSE} 
 startups %>%  
   mutate(outlier = ifelse(is_outlier(age_of_company_in_years), age_of_company_in_years, as.numeric(NA))) %>%
   ggplot(., aes(x = 1,y = age_of_company_in_years)) +
   geom_boxplot(outlier.color = "red") +
   geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```
## more visulization approve
```{r }
pairs.panels(startups[,3:4], gap=0, bg= c("red", "green")[startups$`dependent-company_status`], pch= 21)
```
 The plot shows that there is a CLEAR negative correlation between the two predictors, and also having the same distribution; therefore we need to deal with NA carefully to make it
normally distributed,and at the end we will be using ONLY one feature of these.
This function(pais.panel) help us to make further investigation between the relations of some related features.

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$age_of_company_in_years), startups$age_of_company_in_years, as.numeric(NA))
outlier_count <- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```
In this `age_of_company_in_years`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# summary internet_activity_score
```{r Feature Summary }
summary(startups$internet_activity_score)
```
## list of the values, and their count
```{r}
count(startups, internet_activity_score)
```
## percentage of NA value in internet_activity_score
```{r}
(count(startups, internet_activity_score=="NA"))$freq[2]/nrow(startups)*100
```
## couning NA based on Company state
```{r }
count(startups[is.na(startups$internet_activity_score), 2])
```  
We found that 2/3 of the NA of internet_activity_score is failed, and 1/3 are success
We can deal with NA with two medians, one for failed and other for success

## Visualiziobg 
```{r, warning=FALSE}
ggplot(startups, aes(x=internet_activity_score, fill=startups$`dependent-company_status`)) + 
  geom_density(alpha=0.4 ) +
  labs(title = "internet_activity_score\n", x = "internet_activity_score", y = "Percentage", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```
We need to figure out how a company has a negative Internet Activity Score !!!

## figuiring out the outlier and labeld them
```{r Feature Outliers,warning=FALSE}
startups %>%  
  mutate(outlier = ifelse(is_outlier(internet_activity_score), internet_activity_score, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = internet_activity_score)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```
## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$internet_activity_score), startups$internet_activity_score, as.numeric(NA))
outlier_count <- count(outlier!="NA")$freq[1]
outlier_percnt <- count(outlier!="NA")$freq[1]/nrow(startups)*100
```
In this `internet_activity_score`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# Summary of employee_count feature
```{r}
summary(startups$employee_count)
```
## list of the values, and their count
```{r}
count(startups$employee_count)
```
## percentage of NA value in internet_activity_score
```{r}
(count(startups$employee_count=="NA"))$freq[2]/nrow(startups)*100
```
 
approximately 36% of the data is NA, propably its good if we can remove this feature.

# Visual test
```{r , warning=FALSE}
ggplot(startups, aes(x=employee_count , fill=startups$`dependent-company_status`)) + 
  geom_density(alpha= 0.2,aes(y=..count..))  +
  labs(title = "employee_count\n", x = "employee_count", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```
No clear distinguis beween the status of company based on employee_count

# summary of last_funding_amount feature
```{r}
summary(startups$last_funding_amount)
```
## list of the values, and their count
```{r}
count(startups$last_funding_amount)
```
# percentage of NA value in internet_activity_score
```{r}
count(startups$last_funding_amount=="NA")$freq[2]/nrow(startups)*100
```
Once more, about 34% of the data is misssing

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r, warning=FALSE}
ggplot(startups, aes(x=last_funding_amount, fill=startups$`dependent-company_status`)) + 
  geom_density(alpha= 0.2,aes(y=..count..))    +
  labs(title = "last_funding_amount\n", x = "last_funding_amount", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

NO clear findout we can have. 
## Figuring out the outlier and labeld them
```{r, warning=FALSE}
startups %>%  
  mutate(outlier = ifelse(is_outlier(last_funding_amount), last_funding_amount, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = last_funding_amount)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```
## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$last_funding_amount), startups$last_funding_amount, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```
We have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# summary of number_of_investors_in_seed feature 
```{r}
summary(startups$number_of_investors_in_seed)
```
## list of the values, and their count
```{r}
count(startups$number_of_investors_in_seed)
```
## percentage of NA value in internet_activity_score
```{r}
(count(startups$number_of_investors_in_seed=="NA")$freq[2]/nrow(startups))*100
```   
 10% of the data is missing

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=as.factor(number_of_investors_in_seed) , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Number Of Investors in Seed\n", x = "Investors #", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

The bar shows that the most succee and failed companies are located in the first section, and the number of seed investor less than 4, and also the NA data for this features seems to be failed , overwhelmingly we can replace the NA with failed company status with median, and the success one with the median of success compnaies.

## Figuring out the outlier and labeld them
```{r, warning=FALSE}
startups %>%  
  mutate(outlier = ifelse(is_outlier(number_of_investors_in_seed), number_of_investors_in_seed, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = number_of_investors_in_seed)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```
## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$number_of_investors_in_seed), startups$number_of_investors_in_seed, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```

In this `number_of_investors_in_seed`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

## frequency of the company sattus when NA applied
```{r}
count(startups[is.na(startups$number_of_investors_in_seed), 2])
```

# Summary of the number_of_investors_in_angel_and_or_vc feature
```{r}
summary(startups$number_of_investors_in_angel_and_or_vc)
```
## list of the values, and their count
```{r}
count(startups$number_of_investors_in_angel_and_or_vc)
```

## percentage of NA value in internet_activity_score
```{r}
(count(startups$number_of_investors_in_angel_and_or_vc=="NA")$freq[2]/nrow(startups))*100
``` 

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 

```{r}
ggplot(startups, aes(x=as.factor(number_of_investors_in_angel_and_or_vc) , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..))) + scale_y_continuous( name = "%", labels=scales::percent) +
  labs(title = "Number of Investors in Angel and/or Vc\n", x = "Investors # Angel/VC \n",  fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```
   
The bar shows that the most succee and failed companies are located in the first section, 
`number_of_investors_in_angel_and_or_vc`, and also the NA data for this features seems to be failed overwhelmingly, we can replace the NA with failed company status with median, and the success one with the median of success compnaies. In other word, we can convert this feature to categorical variable; 0 or others

## Figuring out the outlier and labeld them
```{r}
startups %>%  
  mutate(outlier = ifelse(is_outlier(number_of_investors_in_angel_and_or_vc), number_of_investors_in_angel_and_or_vc, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = number_of_investors_in_angel_and_or_vc)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```

It appears only, the 0 value is identical while other aren't, and this clear when we check 
the count function to know each value's frequency

## counting outlier and finding their percentage
```{r,warning=FALSE}
outlier = ifelse(is_outlier(startups$number_of_investors_in_angel_and_or_vc), startups$number_of_investors_in_angel_and_or_vc, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```
In this `number_of_investors_in_angel_and_or_vc`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

## frequency of the company sattus
```{r}
count(startups[is.na(startups$number_of_investors_in_angel_and_or_vc), 2])
```  

Only 3 companies success, and almost 10% failed with NA value, it looks like there is no clear significant for this feature, as it didn't clearly  affect the company status, this could be clear if we repalce the missing value with 0 value  then, balance might take place
we will do other test withis feature and number_of_investors_in_seed

## check missing values between 
```{r}
md.pattern(startups[,17:18])
```

## more visulization approve
```{r}
pairs.panels(startups[,17:18], gap=0, bg= c("red", "green")[startups$`dependent-company_status`], pch= 21)
```

Weak correlation between them, even if they share some properities.

## Summary of number_of_co-founders feature 
```{r}
summary(startups$'number_of_co-founders')
```

## list of the values, and their count
```{r}
count(startups$'number_of_co-founders')
```

## percentage of NA value in internet_activity_score
```{r}
(count(startups$'number_of_co-founders'=="NA")$freq[2]/nrow(startups))*100
```  
  
No missing value for this feature, this might indicate to the significant role of this feature.

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=as.factor(`number_of_co-founders`), fill=startups$'dependent-company_status')) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Companies' Co-founder # ", x = "Co-founder #", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

It's clearly that, this feature has normal distribution

## density geom
```{r}
ggplot(startups, aes(x=`number_of_co-founders`)) + 
  geom_density()
```

## Figuring out the outlier and labeld them
```{r}
startups %>%  
  mutate(outlier = ifelse(is_outlier(`number_of_co-founders`), `number_of_co-founders`, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = `number_of_co-founders`)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```   

Values above 4 considered outlire

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$`number_of_co-founders`), startups$`number_of_co-founders`, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```
In this `number_of_co-founders`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# Summary of number_of_of_advisors feature
```{r}
summary(startups$number_of_of_advisors)
```

## list of the values, and their count
```{r}
count(startups$number_of_of_advisors)
```

## percentage of NA value in internet_activity_score
```{r}
(count(startups$number_of_of_advisors=="NA")$freq[2]/nrow(startups))*100
```
 
There is no NA value in this features.

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=as.factor(number_of_of_advisors) , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Number of Advisors per company\n", x = "Advisors #", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

The graph shows that, around 62% of the companies don't have advisors, and the more company has advisors, the more likely this compnay will have start-up success case, and the grapg shows also that this feature has high-right skewed distribution, and this could be due to the outliers.

## Figuring out the outlier and labeld them
```{r}
startups %>%  
  mutate(outlier = ifelse(is_outlier(number_of_of_advisors), number_of_of_advisors, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = number_of_of_advisors)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```

Looks like, any value avove of 2 advisors would be considered as outlier, and as we figure out 
when using summary function that 62% of the compnay dont have advisors.

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$number_of_of_advisors), startups$number_of_of_advisors, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```

In this `number_of_of_advisors`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.
 
# Summary of team_size_senior_leadership feature 

```{r}
summary(startups$team_size_senior_leadership)
```

## list of the values, and their count

```{r}
count(startups$team_size_senior_leadership)
```

## percentage of NA value in internet_activity_score
```{r}
(count(startups$team_size_senior_leadership=="NA")$freq[2]/nrow(startups))*100
```
  
No NA value for this feature.

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=as.factor(team_size_senior_leadership) , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Number of Senior Leadership\n", x = "Senior Leadership #", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

This feature refers to that, the more senior leadership members a compnay has, the more likely the compnay would be success. Moreover, the feature look it has a right-skewed distribution.

## Figuring out the outlier and labeld them
```{r}
startups %>%  
  mutate(outlier = ifelse(is_outlier(team_size_senior_leadership), team_size_senior_leadership, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = team_size_senior_leadership)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```
  
Looke that an outliervalue could be calculatedas above of 9 senior leadership.

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$team_size_senior_leadership), startups$team_size_senior_leadership, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```

In this `age_of_company_in_years`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# Summary of team_size_all_employees feature

```{r}
summary(startups$team_size_all_employees)
```

## list of the values, and their count

```{r}
count(startups$team_size_all_employees)
```

## percentage of NA value in internet_activity_score

```{r}
(count(startups$team_size_all_employees=="NA")$freq[2]/nrow(startups))*100
```
It looks like there is a 14.5% a NA value, which need to be addressed and replaced by an approp
appropriate value in order to keep the feature shape normally distributed.


## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=team_size_all_employees , fill=startups$`dependent-company_status`)) + 
  geom_histogram(bins = 10 , aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Number of Employees\n", x = "Employees #", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

The graph show that there is a high-right skewed distributoin.

```{r}
ggplot(startups, aes(x=team_size_all_employees)) +
  geom_density( )
```

## Figuring out the outlier and labeld them

```{r}
startups %>%  
  mutate(outlier = ifelse(is_outlier(team_size_all_employees), team_size_all_employees, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = team_size_all_employees)) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$team_size_all_employees), startups$team_size_all_employees, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```

In this `team_size_all_employees`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# Summary of presence_of_a_top_angel_or_venture_fund_in_previous_round_of_investment feature

```{r}
summary(startups$presence_of_a_top_angel_or_venture_fund_in_previous_round_of_investment)
```

## list of the values, and their count
```{r}
count(startups$presence_of_a_top_angel_or_venture_fund_in_previous_round_of_investment)
```

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=presence_of_a_top_angel_or_venture_fund_in_previous_round_of_investment , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Presence ", x = "YES/NO", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```
   
We can impement NA value in Decision tree algorith, asit has a big percent.
 
## frequency of the company sattus
```{r}
count(startups[is.na(startups$presence_of_a_top_angel_or_venture_fund_in_previous_round_of_investment), 2])
```

This statement shows the company start-up status when thhis feature has a NA value, lookd like
there is clear pattern, therefore we can use this value in implementing our algorithm.

# Summary of number_of_of_repeat_investors feature

```{r}
summary(startups$number_of_of_repeat_investors)
```

## list of the values, and their count

```{r}
count(startups$number_of_of_repeat_investors)
```

## percentage of NA value in internet_activity_score

```{r}
(count(startups$number_of_of_repeat_investors=="NA")$freq[2]/nrow(startups))*100
```

There is around 9% NA of this feature.

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=as.factor(number_of_of_repeat_investors) , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Number of Repeat Investors \n", x = "Investors #", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

The graph shows that, around 63% of the companies don't have repated invstors, and the NA is failed startup companies, which will help us in determining the most appropriate value to replace the NA with, which is 0 in this case. We can convert this feature to categorical type

## Figuring out the outlier and labeld them
```{r}
startups %>%  
  mutate(outlier = ifelse(is_outlier(number_of_of_repeat_investors), number_of_of_repeat_investors, as.numeric(NA))) %>%
  ggplot(., aes(x = 1,y = 'number_of_of_repeat_investors')) +
  geom_boxplot(outlier.color = "red") +
  geom_text(aes(label = outlier), na.rm = TRUE, hjust = -0.3, color="red")
```

## counting outlier and finding their percentage
```{r}
outlier = ifelse(is_outlier(startups$number_of_of_repeat_investors), startups$number_of_of_repeat_investors, as.numeric(NA))
outlier_count<- count(outlier!="NA")$freq[1]
outlier_percnt <- (count(outlier!="NA")$freq[1]/nrow(startups))*100
```

In this `number_of_of_repeat_investors`, we have `outlier_count` outlier value, which is around `outlier_percnt` of the total values.

# Summary of number_of__sales_support_material feature  

```{r}
summary(startups$number_of__sales_support_material)
```
## list of the values, and their count

```{r}
count(startups$number_of__sales_support_material)
```  

This feature has Nothing value as one of its factors, and this needs to be treated as what value could rather than low, medium and high.

## percentage of NA value in internet_activity_score

```{r}
(count(startups$number_of__sales_support_material=="NA")$freq[2]/nrow(startups))*100
```  

Almost 10% is NA

## drawing a histogram of  the feature to know its type of distribution which will help us
## in figuring out the best method to deal with NA vales 
```{r}
ggplot(startups, aes(x=number_of__sales_support_material , fill=startups$`dependent-company_status`)) + 
  geom_bar(aes(y = ..count../sum(..count..)))   +   scale_y_continuous(name = "%", labels=scales::percent) +
  labs(title = "Number of Sales Support Material\n", x = "Sales Support # ", y = "Count", fill= "Success|Failed\n ") +
  scale_fill_manual(labels = c("FAILED", "SUCCESS"), values = c("red", "green")) +
  theme_bw() +
  theme(axis.text.x=element_text(size=14), axis.title.x=element_text(size=16),
        axis.text.y=element_text(size=14), axis.title.y=element_text(size=16),
        plot.title=element_text(size=20, face="bold", color="darkgreen"))
```

The graph shows that this feature has approximately normal distribution, and most of the NA values have failed start-up company status.

# Summary of years_of_education feature

```{r}
summary(startups$years_of_education)
```

## list of the values, and their count

```{r}
count(startups$years_of_education)
```

## percentage of NA value in internet_activity_score

```{r}
(count(startups$years_of_education=="NA")$freq[2]/nrow(startups))*100
```

Multiple values with  each recoreded, except only one value which probably 

# Summary of number_of_recognitions_for_founders_and_co-founders feature 

```{r}
summary(startups$'number_of_recognitions_for_founders_and_co-founders')
```

### list of the values, and their count

```{r}
count(startups$'number_of_recognitions_for_founders_and_co-founders')
```

### percentage of NA value in internet_activity_score

```{r}
(count(startups$'number_of_recognitions_for_founders_and_co-founders'=="NA")$freq[2]/nrow(startups))*100
```

We have around 17% of the feature's values are missing

# Exploratory Data Analysis

# Feature Engineering

# Pre-Modeling Processing
## Missing Values

## More Exploration

## Hypothesis Testing

## Predictor Selection

