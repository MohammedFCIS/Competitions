---
title: "Startups Business Analytics"
author: "Mohammed Ali"
date: "February 17, 2018"
output:
    html_document:
      toc : true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
```

# Objective
Our main goal here is to see how we can walk through a business case to analysis it and conclude useful results from it. Although the dataset here is dummy one but it has the same issues for any real dataset, except the huge size, like:

* A lot of predictors to comperhend and get usefl info from them.
* Data has a lot of missing, unclear items.
* Amiguate relation between the predictors

So let us begin our journey.

# Data Wrangling
First we will read the data using `read_csv` methof from `readr` packing within `tidyverse` package.

```{r read_data, message=FALSE}
startups <- read_csv("data/CAX_Startup_Data.csv")
```
So we have `r nrow(startups)` observations belongs to `r ncol(startups)` variables, one of them is the response variable that we would to designate later for predction and the rest are the predictors.

Now, let us take a `glimpse` of the data
```{r data_glimpse}
str(startups)
```

Clearly, taking `glimpse` of data was not so useful here due to huge amount of variables, so let us see how the first 4 rows of the data looks like
```{r data_head}
head(startups, 5)
```

Ok, it is a **little** better, from that it seems we have the following notes:

* There are many missong values 
* Missing values are not only marked as `NA` but there are other values like `No Info` or just an empty string.
* Varaible are read as _characters_ datatype by default and would need to be probably converted to their _original_ data type(dates, factors, numeric)
* There are variables clearly will need special processing like `Short Description of company profile` , `Specialization of highest education` or `
Investors`
* There are issues in texual columns (upper and lower case, different format, etc..)
* Clearly `Dependent-Company Status` is the response variable.

So, the following are the steps we will conduct to clean our dataset

* Will convert the variables into their proper datatypes.
* Unify the way missing data are marked.
* Remove column with missed data over 40%.

## Variables Correct type
First let us write the methods that are needed for each conversion

```{r to_factor}
to_factor<- function(index) {
   # Replace 'No Info' with NA
  startups[[index]][startups[[index]] == 'No Info'] <- NA
  # Replace empty string with NA
  startups[[index]][startups[[index]] == ''] <- NA
  # Unify the case
  startups[[index]] <- toupper(startups[[index]])
  # Convert to factor
  return(as.factor(startups[[index]]))
}
```

```{r to_numeric}
to_numeric<- function(index) {
   # Replace 'No Info' with NA
  startups[[index]][startups[[index]] == 'No Info'] <- NA
  # Replace empty string with NA
  startups[[index]][startups[[index]] == ''] <- NA
  # Convert to numeric
  return(as.numeric(startups[[index]]))
}
```


```{r to_date}
to_date<- function(index) {
   # Replace 'No Info' with NA
  startups[[index]][startups[[index]] == 'No Info'] <- NA
  # Replace empty string with NA
  startups[[index]][startups[[index]] == ''] <- NA
  # Convert to date
  return(mdy(startups[[index]]))
}
```

Now we write a generel method to switch to correct variable data types
```{r correct_type}
correct_type <- function(index, type) {
  switch (type,
    "factor" = to_factor(index),      
    "numeric" = to_numeric(index),
    "date" = to_date(index)
  )
  return(startups[[index]])
}
```

### Factor Variables
Construct factor of factor variables and convert them

```{r convert_factors}
factor_cols <- c(2, 12, 16:17, 24, 26:65, 67, 71, 73, 75:87, 89:91, 93, 97, 100:101)
startups[, factor_cols] <- map(factor_cols, to_factor)
```

### Numeric Variables
Construct factor of numeric variables and convert them

```{r convert_numeric}
numeric_cols <- c(3:5,10,11,18:23,25,61,66,68:70,72,74,88,92,94:96,98,99,102:116)
startups[, numeric_cols] <- map2(numeric_cols, "numeric", correct_type)
```

### Date Variables
Construct factor of date variables and convert them

```{r convert_date}
date_cols <- c(13:14)
startups[, date_cols] <- map2(date_cols, "date", correct_type)
```

## Remove polluted predictors
Now, as the variables in their proper data types, let us remove predictors with more than 40% missing data

```{r remove_poll_vars}
startups <- startups[colSums(is.na(startups))/nrow(startups) < .4]
dim(startups)
```

# Exploratory Data Analysis

# Feature Engineering

# Pre-Modeling Processing
## Missing Values

## More Exploration

## Hypothesis Testing

## Predictor Selection
